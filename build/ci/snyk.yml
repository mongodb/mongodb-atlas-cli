tasks:
  - name: snyk_monitor
    tags:
    - snyk
    commands:
      - command: shell.exec
        params:
          include_expansions_in_env:
            - workdir
          shell: bash
          script: |
            docker run \
              --rm \
              -e SNYK_TOKEN=${SNYK_TOKEN} \
              -e SNYK_CFG_ORG=${SNYK_ORG} \
              -v ${workdir}/src/github.com/mongodb/mongodb-atlas-cli:/app \
              snyk/snyk:golang snyk monitor

buildvariants:
- name: ubuntu
  display_name: Snyk
  tags:
  - snyk
  - cron
  run_on:
  - ubuntu2204-large
  tasks:
    - name: ".snyk"

patch_aliases:
  - alias: "snyk"
    variant_tags: [".snyk .cron"]
    task: ".*"